<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëœë¤ ì¶”ì²¨ ê²Œì„</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', sans-serif;
            background-color: #121212;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            overflow: hidden;
            transition: background-color 0.5s;
        }

        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #f5f5f5;
        }

        .input-section {
            margin-bottom: 2rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        input {
            padding: 12px;
            font-size: 1.1rem;
            width: 120px;
            border: none;
            border-radius: 8px;
            background-color: #333;
            color: white;
            text-align: center;
        }

        button {
            padding: 12px 24px;
            font-size: 1.1rem;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
        }

        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 300px;
            margin: 2rem 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            perspective: 1000px;
        }

        .participant {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #e91e63;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.5s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: default;
            opacity: 0;
            transform: scale(0);
        }

        .finalist {
            background-color: #4CAF50;
            transform: scale(1.2) !important;
            z-index: 10;
            box-shadow: 0 0 20px 5px rgba(76, 175, 80, 0.7);
        }

        .eliminated {
            opacity: 0.3 !important;
            transform: scale(0.8) !important;
        }

        .winner {
            background-color: #FFC107;
            transform: scale(2) !important;
            z-index: 100;
            box-shadow: 0 0 30px 10px rgba(255, 193, 7, 0.7);
            animation: winner-pulse 1.5s infinite;
        }

        @keyframes winner-pulse {
            0% {
                box-shadow: 0 0 30px 5px rgba(255, 193, 7, 0.7);
            }
            50% {
                box-shadow: 0 0 30px 15px rgba(255, 193, 7, 0.9);
            }
            100% {
                box-shadow: 0 0 30px 5px rgba(255, 193, 7, 0.7);
            }
        }

        .result-announcement {
            font-size: 2rem;
            font-weight: bold;
            margin-top: 1rem;
            height: 3rem;
            color: #FFC107;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
            opacity: 0;
            transition: opacity 0.5s;
        }

        .controls {
            margin-top: 1rem;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f0f;
            opacity: 0;
        }

        .drum-sound {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #aaa;
        }

        .sound-toggle {
            background: none;
            border: 1px solid #555;
            color: #aaa;
            padding: 5px 10px;
            font-size: 0.9rem;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }

        .sound-on {
            color: #4CAF50;
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ ëœë¤ ì¶”ì²¨ ê²Œì„</h1>
        
        <div class="input-section">
            <label for="participants">ì°¸ê°€ì ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”</label>
            <input type="number" id="participants" min="2" max="100" value="10">
            <button id="startBtn">ì‹œì‘í•˜ê¸°</button>
            <button id="resetBtn" disabled>ë‹¤ì‹œí•˜ê¸°</button>
        </div>
        
        <div class="game-area" id="gameArea">
            <!-- ì°¸ê°€ìë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
        
        <div class="result-announcement" id="resultAnnouncement"></div>
        
        <div class="drum-sound">
            <span>íš¨ê³¼ìŒ</span>
            <button class="sound-toggle sound-on" id="soundToggle">ì¼œê¸°</button>
        </div>
    </div>

    <script>
        // ìš”ì†Œ ì°¸ì¡°
        const participantsInput = document.getElementById('participants');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const gameArea = document.getElementById('gameArea');
        const resultAnnouncement = document.getElementById('resultAnnouncement');
        const soundToggle = document.getElementById('soundToggle');
        
        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        let participants = [];
        let isGameRunning = false;
        let finalRound = false;
        let soundEnabled = true;
        let drumrollSound;
        let successSound;
        
        // ì˜¤ë””ì˜¤ ì´ˆê¸°í™”
        function initAudio() {
            // ë“œëŸ¼ë¡¤ ì‚¬ìš´ë“œ ìƒì„±
            drumrollSound = new Audio();
            drumrollSound.src = 'data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCvAM+BSQGrQdyCTMLrgxZDrsPXxT/FZcXOBm7EbsWRxzqHz4h8RXMCiAB8PkA83LtZucB4jXc+dyT3pjheuSD52/qh+x/7vLxZ/W195X64vw0//0AYwJHBIAGDAgZCrQL4wz+DRcPPhBREfwRaxKREqQSaxIVEugRWxH5EHEQgxAVEQwRexCxDv0Lwgi3BbECCwC2/Tr7s/gb9j30JPKz7zrt7Op36OfmcOW45J3kn+Tz5eLoVexX8Dv0tfcT+z7+0wFPBZQI/gupDuEQzBK0FBMWOxcxGAQZpRkEGhca3RmXGQ==';

            // ì„±ê³µ ì‚¬ìš´ë“œ ìƒì„±
            successSound = new Audio();
            successSound.src = 'data:audio/wav;base64,UklGRigCAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQCAACBAAAALAEAAFgCAABvAwAAgAQAAIsFAACVBgAAyAcAAMQIAAD/CQAADAsAAEAMAAB5DQAAngQAAKYFAACuBgAAwwcAALsIAAD0CQAABQsAADUMAABuDQAAeAwAAIANAACCDgAA8Q8AAPMQAABLEgAAZhMAALMUAAC4FQAACxcAABAYAABAGQAAQRoAAFwbAABhHAAAXh0AAH4eAABmHwAAkSAAAIQhAACfIgAAmCMAAK4kAACjJQAAuSYAAMUnAADCKAAAyykAAMMqAADIKwAAxiwAAMwtAADBLgAA0S8AAMIwAADCMQAAtzIAALgzAACnNAAAqDUAAJU2AACWNwAAiTgAAIo5AAB9OgAAfzsAAG48AABvPQAAYj4AAF8/AABTQAAAUEEAAENCAAAyQwAAJ0QAADhFAAAuRgAAG0cAAA5IAAACSQAANUoAACVLAAAXTAAAEE0AAAROAAAFTwAAB1AAAAxRAAABUgAACFMAAAtUAAAGVQAADFYAABBXAAAMWAAACVkAABxaAAAZWwAAJFwAAB9dAAAbXgAAFF8AACpgAAAtYQAAKGIAACNjAAAoZAAAKmUAAChmAAAjZwAAP2gAADxpAAA0agAAM2sAADBsAAAmSwAABkoAANtIAAB4RwAAwkUAAOVCAADIP0AAxzxVAKc5NwDMNkcAoDSAAAA=';
        }

        // ì‚¬ìš´ë“œ í† ê¸€
        soundToggle.addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            if (soundEnabled) {
                soundToggle.classList.add('sound-on');
                soundToggle.textContent = 'ì¼œê¸°';
            } else {
                soundToggle.classList.remove('sound-on');
                soundToggle.textContent = 'ë„ê¸°';
            }
        });

        // ê²Œì„ ì‹œì‘
        startBtn.addEventListener('click', function() {
            const count = parseInt(participantsInput.value);
            if (count < 2 || count > 100) {
                alert('2ëª…ì—ì„œ 100ëª… ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            initAudio();
            startGame(count);
        });

        // ê²Œì„ ë¦¬ì…‹
        resetBtn.addEventListener('click', function() {
            resetGame();
        });

        // ê²Œì„ ì‹œì‘ í•¨ìˆ˜
        function startGame(count) {
            if (isGameRunning) return;
            
            isGameRunning = true;
            finalRound = false;
            
            // UI ì—…ë°ì´íŠ¸
            startBtn.disabled = true;
            participantsInput.disabled = true;
            resultAnnouncement.style.opacity = 0;
            gameArea.innerHTML = '';
            document.body.style.backgroundColor = '#121212';
            
            // ì°¸ê°€ì ì´ˆê¸°í™”
            participants = [];
            for (let i = 1; i <= count; i++) {
                participants.push({
                    id: i,
                    element: null,
                    eliminated: false
                });
            }
            
            // ì°¸ê°€ì ìš”ì†Œ ìƒì„± ë° ë°°ì¹˜
            createParticipants();
            
            // ê²Œì„ ì§„í–‰
            setTimeout(() => runGame(), 1000);
        }

        // ì°¸ê°€ì ìš”ì†Œ ìƒì„±
        function createParticipants() {
            const gameAreaRect = gameArea.getBoundingClientRect();
            const width = gameAreaRect.width;
            const height = gameAreaRect.height;
            
            participants.forEach((participant, index) => {
                const element = document.createElement('div');
                element.className = 'participant';
                element.textContent = participant.id;
                
                const angle = (index / participants.length) * Math.PI * 2;
                const radius = Math.min(width, height) * 0.4;
                
                const x = width / 2 + radius * Math.cos(angle) - 30;
                const y = height / 2 + radius * Math.sin(angle) - 30;
                
                element.style.left = `${x}px`;
                element.style.top = `${y}px`;
                
                gameArea.appendChild(element);
                participant.element = element;
                
                // ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ë“±ì¥
                setTimeout(() => {
                    element.style.opacity = 1;
                    element.style.transform = 'scale(1)';
                }, 50 + index * 50);
            });
        }

        // ê²Œì„ ì§„í–‰
        function runGame() {
            // ë‚¨ì€ ì°¸ê°€ì ì°¾ê¸°
            const remainingParticipants = participants.filter(p => !p.eliminated);
            
            // ê²Œì„ ì¢…ë£Œ ì¡°ê±´
            if (remainingParticipants.length === 1) {
                announceWinner(remainingParticipants[0]);
                return;
            }
            
            // ë§ˆì§€ë§‰ ë¼ìš´ë“œ ì²´í¬ (2ëª… ë‚¨ì•˜ì„ ë•Œ)
            if (remainingParticipants.length === 2 && !finalRound) {
                finalRound = true;
                
                // ìµœì¢… ê²°ìŠ¹ì „ìœ¼ë¡œ ì „í™˜
                remainingParticipants.forEach(p => {
                    p.element.classList.add('finalist');
                });
                
                // ê¸´ì¥ê° ì¡°ì„±
                if (soundEnabled) {
                    drumrollSound.play();
                }
                
                document.body.style.backgroundColor = '#1a237e';
                
                // 3ì´ˆ í›„ ìµœì¢… ê²°ê³¼
                setTimeout(() => runGame(), 3000);
                return;
            }
            
            // ì¼ì • ìˆ˜ì˜ ì°¸ê°€ì íƒˆë½
            const eliminationCount = finalRound ? 1 : Math.ceil(remainingParticipants.length * 0.4);
            const shuffled = [...remainingParticipants].sort(() => 0.5 - Math.random());
            
            // íƒˆë½ì ì²˜ë¦¬
            for (let i = 0; i < eliminationCount && i < shuffled.length; i++) {
                const toEliminate = shuffled[i];
                toEliminate.eliminated = true;
                toEliminate.element.classList.add('eliminated');
            }
            
            // ë‹¤ìŒ ë¼ìš´ë“œ
            setTimeout(() => runGame(), finalRound ? 0 : 800);
        }

        // ìŠ¹ì ë°œí‘œ
        function announceWinner(winner) {
            if (soundEnabled) {
                drumrollSound.pause();
                successSound.play();
            }
            
            winner.element.classList.add('winner');
            document.body.style.backgroundColor = '#ff6f00';
            
            // ì¶•í•˜ ë©”ì‹œì§€
            resultAnnouncement.textContent = `ğŸ‰ ${winner.id}ë²ˆì´ ë‹¹ì²¨ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰`;
            resultAnnouncement.style.opacity = 1;
            
            // ìƒ‰ì¢…ì´ íš¨ê³¼
            createConfetti();
            
            // ê²Œì„ ì¬ì‹œì‘ ê°€ëŠ¥
            resetBtn.disabled = false;
            isGameRunning = false;
        }

        // ìƒ‰ì¢…ì´ íš¨ê³¼
        function createConfetti() {
            const colors = ['#FFC107', '#4CAF50', '#2196F3', '#E91E63', '#9C27B0'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = '0';
                confetti.style.opacity = '1';
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                // ìƒ‰ì¢…ì´ ì• ë‹ˆë©”ì´ì…˜
                const duration = Math.random() * 3 + 2;
                confetti.style.animation = `confettiDrop ${duration}s linear forwards`;
                
                // ìŠ¤íƒ€ì¼ ì¶”ê°€
                const keyframe = document.createElement('style');
                keyframe.innerHTML = `
                    @keyframes confettiDrop {
                        0% { 
                            transform: translateY(0) rotate(${Math.random() * 360}deg); 
                            opacity: 1;
                        }
                        100% { 
                            transform: translateY(${window.innerHeight}px) rotate(${Math.random() * 720}deg); 
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(keyframe);
                
                // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ì œê±°
                setTimeout(() => {
                    document.body.removeChild(confetti);
                    document.head.removeChild(keyframe);
                }, duration * 1000);
            }
        }

        // ê²Œì„ ë¦¬ì…‹
        function resetGame() {
            gameArea.innerHTML = '';
            resultAnnouncement.style.opacity = 0;
            document.body.style.backgroundColor = '#121212';
            
            startBtn.disabled = false;
            participantsInput.disabled = false;
            resetBtn.disabled = true;
            
            // ë‚¨ì•„ìˆëŠ” ìƒ‰ì¢…ì´ ì œê±°
            document.querySelectorAll('.confetti').forEach(c => {
                document.body.removeChild(c);
            });
        }
    </script>
</body>
</html>
