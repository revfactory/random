<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎûúÎç§ Ï∂îÏ≤® Í≤åÏûÑ</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', sans-serif;
            background-color: #121212;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            overflow: hidden;
            transition: background-color 0.5s;
        }

        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #f5f5f5;
        }

        .input-section {
            margin-bottom: 2rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        input {
            padding: 12px;
            font-size: 1.1rem;
            width: 120px;
            border: none;
            border-radius: 8px;
            background-color: #333;
            color: white;
            text-align: center;
        }

        button {
            padding: 12px 24px;
            font-size: 1.1rem;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
        }

        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 300px;
            margin: 2rem 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            perspective: 1000px;
        }

        .participant {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #e91e63;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.5s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: default;
            opacity: 0;
            transform: scale(0);
        }

        .finalist {
            background-color: #4CAF50;
            transform: scale(1.2) !important;
            z-index: 10;
            box-shadow: 0 0 20px 5px rgba(76, 175, 80, 0.7);
        }

        .eliminated {
            opacity: 0.3 !important;
            transform: scale(0.8) !important;
        }

        .winner {
            background-color: #FFC107;
            transform: scale(2) !important;
            z-index: 100;
            box-shadow: 0 0 30px 10px rgba(255, 193, 7, 0.7);
            animation: winner-pulse 1.5s infinite;
        }

        @keyframes winner-pulse {
            0% {
                box-shadow: 0 0 30px 5px rgba(255, 193, 7, 0.7);
            }
            50% {
                box-shadow: 0 0 30px 15px rgba(255, 193, 7, 0.9);
            }
            100% {
                box-shadow: 0 0 30px 5px rgba(255, 193, 7, 0.7);
            }
        }

        .result-announcement {
            font-size: 2rem;
            font-weight: bold;
            margin-top: 1rem;
            height: 3rem;
            color: #FFC107;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
            opacity: 0;
            transition: opacity 0.5s;
        }

        .controls {
            margin-top: 1rem;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f0f;
            opacity: 0;
        }

        .drum-sound {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #aaa;
        }

        .sound-toggle {
            background: none;
            border: 1px solid #555;
            color: #aaa;
            padding: 5px 10px;
            font-size: 0.9rem;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }

        .sound-on {
            color: #4CAF50;
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ ÎûúÎç§ Ï∂îÏ≤® Í≤åÏûÑ</h1>
        
        <div class="input-section">
            <label for="participants">Ï∞∏Í∞ÄÏûê ÏàòÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî</label>
            <input type="number" id="participants" min="2" max="100" value="10">
            <button id="startBtn">ÏãúÏûëÌïòÍ∏∞</button>
            <button id="resetBtn" disabled>Îã§ÏãúÌïòÍ∏∞</button>
        </div>
        
        <div class="game-area" id="gameArea">
            <!-- Ï∞∏Í∞ÄÏûêÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
        </div>
        
        <div class="result-announcement" id="resultAnnouncement"></div>
        
        <div class="drum-sound">
            <span>Ìö®Í≥ºÏùå</span>
            <button class="sound-toggle sound-on" id="soundToggle">ÏºúÍ∏∞</button>
        </div>
    </div>

    <script>
        // ÏöîÏÜå Ï∞∏Ï°∞
        const participantsInput = document.getElementById('participants');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const gameArea = document.getElementById('gameArea');
        const resultAnnouncement = document.getElementById('resultAnnouncement');
        const soundToggle = document.getElementById('soundToggle');
        
        // Í≤åÏûÑ ÏÉÅÌÉú Î≥ÄÏàò
        let participants = [];
        let isGameRunning = false;
        let finalRound = false;
        let soundEnabled = true;
        let drumrollSound;
        let successSound;
        
        // Ïò§ÎîîÏò§ Ï¥àÍ∏∞Ìôî
        function initAudio() {
            // ÎìúÎüºÎ°§ ÏÇ¨Ïö¥Îìú ÏÉùÏÑ±
            drumrollSound = new Audio();
            drumrollSound.src = 'data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCvAM+BSQGrQdyCTMLrgxZDrsPXxT/FZcXOBm7EbsWRxzqHz4h8RXMCiAB8PkA83LtZucB4jXc+dyT3pjheuSD52/qh+x/7vLxZ/W195X64vw0//0AYwJHBIAGDAgZCrQL4wz+DRcPPhBREfwRaxKREqQSaxIVEugRWxH5EHEQgxAVEQwRexCxDv0Lwgi3BbECCwC2/Tr7s/gb9j30JPKz7zrt7Op36OfmcOW45J3kn+Tz5eLoVexX8Dv0tfcT+z7+0wFPBZQI/gupDuEQzBK0FBMWOxcxGAQZpRkEGhca3RmXGQ==';

            // ÏÑ±Í≥µ ÏÇ¨Ïö¥Îìú ÏÉùÏÑ±
            successSound = new Audio();
            successSound.src = 'data:audio/wav;base64,UklGRigCAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQCAACBAAAALAEAAFgCAABvAwAAgAQAAIsFAACVBgAAyAcAAMQIAAD/CQAADAsAAEAMAAB5DQAAngQAAKYFAACuBgAAwwcAALsIAAD0CQAABQsAADUMAABuDQAAeAwAAIANAACCDgAA8Q8AAPMQAABLEgAAZhMAALMUAAC4FQAACxcAABAYAABAGQAAQRoAAFwbAABhHAAAXh0AAH4eAABmHwAAkSAAAIQhAACfIgAAmCMAAK4kAACjJQAAuSYAAMUnAADCKAAAyykAAMMqAADIKwAAxiwAAMwtAADBLgAA0S8AAMIwAADCMQAAtzIAALgzAACnNAAAqDUAAJU2AACWNwAAiTgAAIo5AAB9OgAAfzsAAG48AABvPQAAYj4AAF8/AABTQAAAUEEAAENCAAAyQwAAJ0QAADhFAAAuRgAAG0cAAA5IAAACSQAANUoAACVLAAAXTAAAEE0AAAROAAAFTwAAB1AAAAxRAAABUgAACFMAAAtUAAAGVQAADFYAABBXAAAMWAAACVkAABxaAAAZWwAAJFwAAB9dAAAbXgAAFF8AACpgAAAtYQAAKGIAACNjAAAoZAAAKmUAAChmAAAjZwAAP2gAADxpAAA0agAAM2sAADBsAAAmSwAABkoAANtIAAB4RwAAwkUAAOVCAADIP0AAxzxVAKc5NwDMNkcAoDSAAAA=';
        }

        // ÏÇ¨Ïö¥Îìú ÌÜ†Í∏Ä
        soundToggle.addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            if (soundEnabled) {
                soundToggle.classList.add('sound-on');
                soundToggle.textContent = 'ÏºúÍ∏∞';
            } else {
                soundToggle.classList.remove('sound-on');
                soundToggle.textContent = 'ÎÅÑÍ∏∞';
            }
        });

        // Í≤åÏûÑ ÏãúÏûë
        startBtn.addEventListener('click', function() {
            const count = parseInt(participantsInput.value);
            if (count < 2 || count > 100) {
                alert('2Î™ÖÏóêÏÑú 100Î™Ö ÏÇ¨Ïù¥Î°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                return;
            }
            
            initAudio();
            startGame(count);
        });

        // Í≤åÏûÑ Î¶¨ÏÖã
        resetBtn.addEventListener('click', function() {
            resetGame();
        });

        // Í≤åÏûÑ ÏãúÏûë Ìï®Ïàò
        function startGame(count) {
            if (isGameRunning) return;
            
            isGameRunning = true;
            finalRound = false;
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            startBtn.disabled = true;
            participantsInput.disabled = true;
            resultAnnouncement.style.opacity = 0;
            gameArea.innerHTML = '';
            document.body.style.backgroundColor = '#121212';
            
            // Ï∞∏Í∞ÄÏûê Ï¥àÍ∏∞Ìôî
            participants = [];
            for (let i = 1; i <= count; i++) {
                participants.push({
                    id: i,
                    element: null,
                    eliminated: false
                });
            }
            
            // Ï∞∏Í∞ÄÏûê ÏöîÏÜå ÏÉùÏÑ± Î∞è Î∞∞Ïπò
            createParticipants();
            
            // Í≤åÏûÑ ÏßÑÌñâ
            setTimeout(() => runGame(), 1000);
        }

        // Ï∞∏Í∞ÄÏûê ÏöîÏÜå ÏÉùÏÑ±
        function createParticipants() {
            const gameAreaRect = gameArea.getBoundingClientRect();
            const width = gameAreaRect.width;
            const height = gameAreaRect.height;
            
            participants.forEach((participant, index) => {
                const element = document.createElement('div');
                element.className = 'participant';
                element.textContent = participant.id;
                
                const angle = (index / participants.length) * Math.PI * 2;
                const radius = Math.min(width, height) * 0.4;
                
                const x = width / 2 + radius * Math.cos(angle) - 30;
                const y = height / 2 + radius * Math.sin(angle) - 30;
                
                element.style.left = `${x}px`;
                element.style.top = `${y}px`;
                
                gameArea.appendChild(element);
                participant.element = element;
                
                // Ïï†ÎãàÎ©îÏù¥ÏÖòÏúºÎ°ú Îì±Ïû•
                setTimeout(() => {
                    element.style.opacity = 1;
                    element.style.transform = 'scale(1)';
                }, 50 + index * 50);
            });
        }

        // Í≤åÏûÑ ÏßÑÌñâ
        function runGame() {
            // ÎÇ®ÏùÄ Ï∞∏Í∞ÄÏûê Ï∞æÍ∏∞
            const remainingParticipants = participants.filter(p => !p.eliminated);
            
            // Í≤åÏûÑ Ï¢ÖÎ£å Ï°∞Í±¥
            if (remainingParticipants.length === 1) {
                announceWinner(remainingParticipants[0]);
                return;
            }
            
            // ÎßàÏßÄÎßâ ÎùºÏö¥Îìú Ï≤¥ÌÅ¨ (2Î™Ö ÎÇ®ÏïòÏùÑ Îïå)
            if (remainingParticipants.length === 2 && !finalRound) {
                finalRound = true;
                
                // ÏµúÏ¢Ö Í≤∞ÏäπÏ†ÑÏúºÎ°ú Ï†ÑÌôò
                remainingParticipants.forEach(p => {
                    p.element.classList.add('finalist');
                });
                
                // Í∏¥Ïû•Í∞ê Ï°∞ÏÑ±
                if (soundEnabled) {
                    drumrollSound.play();
                }
                
                document.body.style.backgroundColor = '#1a237e';
                
                // 3Ï¥à ÌõÑ ÏµúÏ¢Ö Í≤∞Í≥º
                setTimeout(() => runGame(), 3000);
                return;
            }
            
            // ÏùºÏ†ï ÏàòÏùò Ï∞∏Í∞ÄÏûê ÌÉàÎùΩ
            const eliminationCount = finalRound ? 1 : Math.ceil(remainingParticipants.length * 0.4);
            const shuffled = [...remainingParticipants].sort(() => 0.5 - Math.random());
            
            // ÌÉàÎùΩÏûê Ï≤òÎ¶¨
            for (let i = 0; i < eliminationCount && i < shuffled.length; i++) {
                const toEliminate = shuffled[i];
                toEliminate.eliminated = true;
                toEliminate.element.classList.add('eliminated');
            }
            
            // Îã§Ïùå ÎùºÏö¥Îìú
            setTimeout(() => runGame(), finalRound ? 0 : 800);
        }

        // ÏäπÏûê Î∞úÌëú
        function announceWinner(winner) {
            if (soundEnabled) {
                drumrollSound.pause();
                successSound.play();
            }
            
            winner.element.classList.add('winner');
            document.body.style.backgroundColor = '#ff6f00';
            
            // Ï∂ïÌïò Î©îÏãúÏßÄ
            resultAnnouncement.textContent = `üéâ ${winner.id}Î≤àÏù¥ ÎãπÏ≤®ÎêòÏóàÏäµÎãàÎã§! üéâ`;
            resultAnnouncement.style.opacity = 1;
            
            // ÏÉâÏ¢ÖÏù¥ Ìö®Í≥º
            createConfetti();
            
            // Í≤åÏûÑ Ïû¨ÏãúÏûë Í∞ÄÎä•
            resetBtn.disabled = false;
            isGameRunning = false;
        }

        // ÏÉâÏ¢ÖÏù¥ Ìö®Í≥º
        function createConfetti() {
            const colors = ['#FFC107', '#4CAF50', '#2196F3', '#E91E63', '#9C27B0'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = '0';
                confetti.style.opacity = '1';
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                // ÏÉâÏ¢ÖÏù¥ Ïï†ÎãàÎ©îÏù¥ÏÖò
                const duration = Math.random() * 3 + 2;
                confetti.style.animation = `confettiDrop ${duration}s linear forwards`;
                
                // Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä
                const keyframe = document.createElement('style');
                keyframe.innerHTML = `
                    @keyframes confettiDrop {
                        0% { 
                            transform: translateY(0) rotate(${Math.random() * 360}deg); 
                            opacity: 1;
                        }
                        100% { 
                            transform: translateY(${window.innerHeight}px) rotate(${Math.random() * 720}deg); 
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(keyframe);
                
                // Ïï†ÎãàÎ©îÏù¥ÏÖò ÏôÑÎ£å ÌõÑ Ï†úÍ±∞
                setTimeout(() => {
                    document.body.removeChild(confetti);
                    document.head.removeChild(keyframe);
                }, duration * 1000);
            }
        }

        // Í≤åÏûÑ Î¶¨ÏÖã
        function resetGame() {
            gameArea.innerHTML = '';
            resultAnnouncement.style.opacity = 0;
            document.body.style.backgroundColor = '#121212';
            
            startBtn.disabled = false;
            participantsInput.disabled = false;
            resetBtn.disabled = true;
            
            // ÎÇ®ÏïÑÏûàÎäî ÏÉâÏ¢ÖÏù¥ Ï†úÍ±∞
            document.querySelectorAll('.confetti').forEach(c => {
                document.body.removeChild(c);
            });
        }
    </script>
</body>
</html>
