<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë•ë¶„ì— ì˜¤ëŠ˜ë„ ì¹¼í‡´ í•©ë‹ˆë‹¤ - ë„ì„œ ì¦ì • ì´ë²¤íŠ¸ ì¶”ì²¨</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', sans-serif;
            background-color: #121212;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            overflow-x: hidden; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            transition: background-color 0.5s;
        }

        .container {
            max-width: 900px; /* ë„ˆë¹„ ì¦ê°€ */
            width: 100%;
            text-align: center;
        }

        h1 {
            font-size: 2.2rem; /* ëª¨ë°”ì¼ ê³ ë ¤í•˜ì—¬ ì•½ê°„ ì¤„ì„ */
            margin-bottom: 1rem;
            color: #f5f5f5;
        }

        .event-description {
            background-color: #222;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: left;
            line-height: 1.6;
            font-size: 0.95rem;
            color: #e0e0e0;
        }

        .event-description h2 {
            font-size: 1.3rem;
            color: #4CAF50;
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
        }

        .event-description strong {
            color: #FFC107;
        }

        .event-description code { /* ì¸ìš© ìŠ¤íƒ€ì¼ */
            background-color: #333;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: monospace;
        }

        .controls {
            margin-bottom: 2rem;
        }

        button {
            padding: 12px 24px;
            font-size: 1.1rem;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
        }

        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-area {
            position: relative;
            width: 100%;
            /* ë†’ì´ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì ˆí•˜ë„ë¡ ë³€ê²½ */
            min-height: 350px; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
            margin: 2rem 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center; /* ìš”ì†Œë“¤ì„ ì¤‘ì•™ ì •ë ¬ */
            gap: 10px; /* ìš”ì†Œ ê°„ ê°„ê²© */
            perspective: 1000px;
            padding: 10px; /* ë‚´ë¶€ ì—¬ë°± ì¶”ê°€ */
            box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„ì— í¬í•¨ë˜ë„ë¡ */
        }

        .participant {
            /* position ì œê±°í•˜ì—¬ flexbox ë ˆì´ì•„ì›ƒ ì‚¬ìš© */
            width: 45px; /* í¬ê¸° ì•½ê°„ ì¤„ì„ */
            height: 45px;
            background-color: #e91e63;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
            color: white;
            transition: all 0.5s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: default;
            opacity: 0;
            transform: scale(0);
        }

        .winner {
            background-color: #FFC107;
            transform: scale(1.5) !important; /* ë‹¹ì²¨ì ê°•ì¡° */
            z-index: 100;
            box-shadow: 0 0 20px 5px rgba(255, 193, 7, 0.7);
            animation: winner-pulse 1.5s infinite;
        }

        @keyframes winner-pulse {
            0% {
                box-shadow: 0 0 20px 5px rgba(255, 193, 7, 0.7);
            }
            50% {
                box-shadow: 0 0 30px 10px rgba(255, 193, 7, 0.9);
            }
            100% {
                box-shadow: 0 0 20px 5px rgba(255, 193, 7, 0.7);
            }
        }

        .result-announcement {
            font-size: 1.8rem; /* í¬ê¸° ì¡°ì • */
            font-weight: bold;
            margin-top: 1rem;
            min-height: 3rem; /* ìµœì†Œ ë†’ì´ ìœ ì§€ */
            color: #FFC107;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            transform: translateY(20px);
        }

        .result-announcement.show {
             opacity: 1;
             transform: translateY(0);
        }

        .confetti {
            position: fixed; /* í™”ë©´ ì „ì²´ì— ë¿Œë ¤ì§€ë„ë¡ ë³€ê²½ */
            width: 10px;
            height: 10px;
            background-color: #f0f;
            opacity: 0;
            top: 0; /* ì‹œì‘ ìœ„ì¹˜ ìƒë‹¨ */
            left: 0; /* ì‹œì‘ ìœ„ì¹˜ ì™¼ìª½ */
            pointer-events: none; /* í´ë¦­ ë°©ì§€ */
            z-index: 9999; /* ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— ë³´ì´ë„ë¡ */
        }

        .drum-sound {
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: #aaa;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sound-toggle {
            background: none;
            border: 1px solid #555;
            color: #aaa;
            padding: 5px 10px;
            font-size: 0.9rem;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            transition: color 0.3s, border-color 0.3s;
        }

        .sound-on {
            color: #4CAF50;
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI ë•ë¶„ì— ì˜¤ëŠ˜ë„ ì¹¼í‡´ í•©ë‹ˆë‹¤</h1>
        <h2>ğŸ“š ë„ì„œ ì¦ì • ì´ë²¤íŠ¸ ì¶”ì²¨ ğŸ (5ëª…)</h2>

        <div class="event-description">
            <h2>ì¹¼í‡´í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? - &lt;AI ë•ë¶„ì— ì˜¤ëŠ˜ë„ ì¹¼í‡´ í•©ë‹ˆë‹¤&gt; 5ë¶„ê»˜ ì±… ë‚˜ëˆ”! ğŸ</h2>
            <p>AIë¥¼ í™œìš©í•´ 'ì¹¼í‡´'ë¥¼ ê¿ˆê¾¸ì‹œëŠ” ë¶„ë“¤ê»˜ ê¸°ìœ ì†Œì‹ì…ë‹ˆë‹¤! ğŸ˜Š <code>@joy.0123</code> ë‹˜ì´ ì§ì ‘ ì§‘í•„í•˜ì‹  ë”°ëˆë”°ëˆí•œ ì‹ ê°„ <strong>"AI ë•ë¶„ì— ì˜¤ëŠ˜ë„ ì¹¼í‡´ í•©ë‹ˆë‹¤"</strong> ì¶œê°„ì„ ê¸°ë…í•˜ì—¬, ëŒ“ê¸€ë¡œ ì°¸ì—¬í•´ì£¼ì‹  100ë¶„ ì¤‘ ì´ 5ë¶„ê»˜ ì±…ì„ ì„ ë¬¼ë¡œ ë“œë¦½ë‹ˆë‹¤.</p>
            <hr style="border-color: #444; margin: 15px 0;">
            <p><strong>âœ¨ ì°¸ì—¬ ì¡°ê±´ âœ¨</strong></p>
            <ul>
                <li>ì‚¬ì „ ì´ë²¤íŠ¸ ê²Œì‹œê¸€ ëŒ“ê¸€ ì°¸ì—¬ì ëŒ€ìƒ (ì„ ì°©ìˆœ 100ëª…)</li>
                <li>ëŒ“ê¸€ì— 1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ í•˜ë‚˜ ê¸°ì¬</li>
                <li>(ì„ íƒ) <code>@joy.0123</code> ë‹˜ì„ ìœ„í•œ ì‘ì› ë©”ì‹œì§€</li>
                <li><strong>ì¤‘ìš”:</strong> ìˆ«ìê°€ ì¤‘ë³µë  ê²½ìš°, ë¨¼ì € ëŒ“ê¸€ì„ ì‘ì„±í•˜ì‹  ë¶„ê»˜ ìš°ì„ ê¶Œ ë¶€ì—¬</li>
            </ul>
            <p><strong>ğŸ“š ì„ ì • ë°©ì‹ ğŸ“š</strong><br>
            ì•„ë˜ 'ì¶”ì²¨ ì‹œì‘!' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, ì°¸ì—¬ì ë²ˆí˜¸ 1ë²ˆë¶€í„° 100ë²ˆ ì¤‘ì—ì„œ ë¬´ì‘ìœ„ë¡œ <strong>5ê°œì˜ ìˆ«ì</strong>ë¥¼ ì¶”ì²¨í•©ë‹ˆë‹¤. í•´ë‹¹ ë²ˆí˜¸ë¥¼ ëŒ“ê¸€ë¡œ ì‘ì„±í•´ì£¼ì‹  5ë¶„ê»˜ ì±…ì„ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤!</p>
            <p style="text-align:center; margin-top:15px;"><code>@group</code> ëª¨ë‘ í–‰ìš´ì„ ë¹Œì–´ìš”! ğŸ€</p>
        </div>

        <div class="controls">
            <button id="startBtn">ì¶”ì²¨ ì‹œì‘!</button>
            <button id="resetBtn" disabled>ë‹¤ì‹œí•˜ê¸°</button>
        </div>

        <div class="game-area" id="gameArea">
            </div>

        <div class="result-announcement" id="resultAnnouncement"></div>

        <div class="drum-sound">
            <span>íš¨ê³¼ìŒ</span>
            <button class="sound-toggle sound-on" id="soundToggle">ì¼œê¸°</button>
        </div>
    </div>

    <script>
        // ìš”ì†Œ ì°¸ì¡°
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const gameArea = document.getElementById('gameArea');
        const resultAnnouncement = document.getElementById('resultAnnouncement');
        const soundToggle = document.getElementById('soundToggle');

        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        const PARTICIPANT_COUNT = 100; // ì°¸ê°€ì ìˆ˜ ê³ ì •
        const WINNER_COUNT = 5; // ë‹¹ì²¨ì ìˆ˜
        let participants = [];
        let isGameRunning = false;
        let soundEnabled = true;
        let drumrollSound;
        let successSound;
        let revealTimeoutIds = []; // ë‹¹ì²¨ì ê³µê°œ íƒ€ì„ì•„ì›ƒ ID ì €ì¥ ë°°ì—´

        // ì˜¤ë””ì˜¤ ì´ˆê¸°í™” (í˜ì´ì§€ ë¡œë“œ ì‹œ í•œë²ˆë§Œ)
        function initAudio() {
             try {
                drumrollSound = new Audio('data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCvAM+BSQGrQdyCTMLrgxZDrsPXxT/FZcXOBm7EbsWRxzqHz4h8RXMCiAB8PkA83LtZucB4jXc+dyT3pjheuSD52/qh+x/7vLxZ/W195X64vw0//0AYwJHBIAGDAgZCrQL4wz+DRcPPhBREfwRaxKREqQSaxIVEugRWxH5EHEQgxAVEQwRexCxDv0Lwgi3BbECCwC2/Tr7s/gb9j30JPKz7zrt7Op36OfmcOW45J3kn+Tz5eLoVexX8Dv0tfcT+z7+0wFPBZQI/gupDuEQzBK0FBMWOxcxGAQZpRkEGhca3RmXGQ==');
                successSound = new Audio('data:audio/wav;base64,UklGRigCAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQCAACBAAAALAEAAFgCAABvAwAAgAQAAIsFAACVBgAAyAcAAMQIAAD/CQAADAsAAEAMAAB5DQAAngQAAKYFAACuBgAAwwcAALsIAAD0CQAABQsAADUMAABuDQAAeAwAAIANAACCDgAA8Q8AAPMQAABLEgAAZhMAALMUAAC4FQAACxcAABAYAABAGQAAQRoAAFwbAABhHAAAXh0AAH4eAABmHwAAkSAAAIQhAACfIgAAmCMAAK4kAACjJQAAuSYAAMUnAADCKAAAyykAAMMqAADIKwAAxiwAAMwtAADBLgAA0S8AAMIwAADCMQAAtzIAALgzAACnNAAAqDUAAJU2AACWNwAAiTgAAIo5AAB9OgAAfzsAAG48AABvPQAAYj4AAF8/AABTQAAAUEEAAENCAAAyQwAAJ0QAADhFAAAuRgAAG0cAAA5IAAACSQAANUoAACVLAAAXTAAAEE0AAAROAAAFTwAAB1AAAAxRAAABUgAACFMAAAtUAAAGVQAADFYAABBXAAAMWAAACVkAABxaAAAZWwAAJFwAAB9dAAAbXgAAFF8AACpgAAAtYQAAKGIAACNjAAAoZAAAKmUAAChmAAAjZwAAP2gAADxpAAA0agAAM2sAADBsAAAmSwAABkoAANtIAAB4RwAAwkUAAOVCAADIP0AAxzxVAKc5NwDMNkcAoDSAAAA=');
                drumrollSound.preload = 'auto';
                successSound.preload = 'auto';
            } catch (e) {
                console.error("ì˜¤ë””ì˜¤ ì´ˆê¸°í™” ì‹¤íŒ¨:", e);
                // ì˜¤ë””ì˜¤ ê°ì²´ ìƒì„± ì‹¤íŒ¨ ì‹œ ë¹„í™œì„±í™”
                soundEnabled = false;
                soundToggle.disabled = true;
                soundToggle.textContent = 'ì˜¤ë¥˜';
             }
        }

        // ì‚¬ìš´ë“œ í† ê¸€
        soundToggle.addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            if (soundEnabled) {
                soundToggle.classList.add('sound-on');
                soundToggle.textContent = 'ì¼œê¸°';
                 // í…ŒìŠ¤íŠ¸ ì‚¬ìš´ë“œ ì¬ìƒ (ì˜µì…˜)
                // try { successSound.play().catch(e => {}); } catch (e) {}
            } else {
                soundToggle.classList.remove('sound-on');
                soundToggle.textContent = 'ë„ê¸°';
                // ì¬ìƒ ì¤‘ì¸ ì‚¬ìš´ë“œ ì¤‘ì§€
                 try {
                    if (drumrollSound && !drumrollSound.paused) drumrollSound.pause();
                    if (successSound && !successSound.paused) successSound.pause();
                } catch(e) {}
            }
        });

        // ê²Œì„ ì‹œì‘
        startBtn.addEventListener('click', function() {
            if (isGameRunning) return;
            startGame();
        });

        // ê²Œì„ ë¦¬ì…‹
        resetBtn.addEventListener('click', function() {
            resetGame();
        });

        // ê²Œì„ ì‹œì‘ í•¨ìˆ˜
        function startGame() {
            isGameRunning = true;

            // UI ì—…ë°ì´íŠ¸
            startBtn.disabled = true;
            resetBtn.disabled = true; // ì¶”ì²¨ ì¤‘ì—ëŠ” ë¦¬ì…‹ ë¹„í™œì„±í™”
            resultAnnouncement.classList.remove('show');
            resultAnnouncement.textContent = ''; // ì´ì „ ê²°ê³¼ ì´ˆê¸°í™”
            gameArea.innerHTML = ''; // ì´ì „ ì°¸ê°€ì ì œê±°
            document.body.style.backgroundColor = '#121212'; // ë°°ê²½ìƒ‰ ì´ˆê¸°í™”

            // ì°¸ê°€ì ì´ˆê¸°í™”
            participants = [];
            for (let i = 1; i <= PARTICIPANT_COUNT; i++) {
                participants.push({
                    id: i,
                    element: null
                });
            }

            // ì°¸ê°€ì ìš”ì†Œ ìƒì„± ë° ë°°ì¹˜
            createParticipants();

            // ì¶”ì²¨ í”„ë¡œì„¸ìŠ¤ ì‹œì‘ (ìƒì„± ì• ë‹ˆë©”ì´ì…˜ í›„)
            setTimeout(() => runSelectionProcess(), 1000 + PARTICIPANT_COUNT * 15); // ë“±ì¥ ì‹œê°„ ê³ ë ¤
        }

        // ì°¸ê°€ì ìš”ì†Œ ìƒì„±
        function createParticipants() {
            participants.forEach((participant, index) => {
                const element = document.createElement('div');
                element.className = 'participant';
                element.textContent = participant.id;

                gameArea.appendChild(element);
                participant.element = element;

                // ìˆœì°¨ì ìœ¼ë¡œ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜
                setTimeout(() => {
                    element.style.opacity = 1;
                    element.style.transform = 'scale(1)';
                }, 50 + index * 15); // ê°„ê²© ì¤„ì—¬ì„œ ë” ë¹¨ë¦¬ í‘œì‹œ
            });
        }

        // ì¶”ì²¨ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰
        async function runSelectionProcess() {
            if (soundEnabled) {
                try {
                   drumrollSound.currentTime = 0; // ì‹œì‘ ì‹œê°„ ì´ˆê¸°í™”
                   drumrollSound.play().catch(e => console.error("ë“œëŸ¼ë¡¤ ì¬ìƒ ì˜¤ë¥˜:", e));
                } catch(e) {}
            }

            // ê¸´ì¥ê° ê³ ì¡° - ë°°ê²½ìƒ‰ ë³€ê²½ ë° ë©”ì‹œì§€
            document.body.style.backgroundColor = '#1a237e'; // ì–´ë‘ìš´ íŒŒë‘
            resultAnnouncement.textContent = 'ë‘êµ¬ë‘êµ¬... ì¶”ì²¨ ì¤‘ì…ë‹ˆë‹¤!';
            resultAnnouncement.classList.add('show');

             // ì ì‹œ ëŒ€ê¸° (ì˜ˆ: 3ì´ˆ)
            await sleep(3000);

             // ì°¸ê°€ì ë°°ì—´ ë³µì‚¬ í›„ ì„ê¸° (Fisher-Yates Shuffle)
            let shuffledParticipants = [...participants];
            for (let i = shuffledParticipants.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledParticipants[i], shuffledParticipants[j]] = [shuffledParticipants[j], shuffledParticipants[i]];
            }

            // ìƒìœ„ Nëª… ì„ ì •
            const winners = shuffledParticipants.slice(0, WINNER_COUNT);

            // ë“œëŸ¼ë¡¤ ì¤‘ì§€
            if (soundEnabled) {
                try { drumrollSound.pause(); } catch(e) {}
            }

            // ë‹¹ì²¨ì ë°œí‘œ ì‹œì‘
            await revealWinnersSequentially(winners);
        }

         // ë‹¹ì²¨ì ìˆœì°¨ ë°œí‘œ
        async function revealWinnersSequentially(winners) {
            resultAnnouncement.textContent = `âœ¨ ${WINNER_COUNT}ëª…ì˜ ë‹¹ì²¨ìë¥¼ ë°œí‘œí•©ë‹ˆë‹¤! âœ¨`;
            await sleep(1500); // ì ì‹œ ëŒ€ê¸°

            let winnerIds = [];
            for (let i = 0; i < winners.length; i++) {
                const winner = winners[i];
                winnerIds.push(winner.id);

                // í•´ë‹¹ ì°¸ê°€ì ê°•ì¡°
                winner.element.classList.add('winner');

                // ê°œë³„ ë°œí‘œ ë©”ì‹œì§€
                resultAnnouncement.textContent = `${i + 1}ë²ˆì§¸ ë‹¹ì²¨ì: ${winner.id}ë²ˆ!`;
                document.body.style.backgroundColor = `hsl(${Math.random() * 360}, 50%, 30%)`; // ëœë¤ ë°°ê²½ìƒ‰

                if (soundEnabled) {
                    try {
                       successSound.currentTime = 0;
                       successSound.play().catch(e => console.error("ì„±ê³µìŒ ì¬ìƒ ì˜¤ë¥˜:", e));
                    } catch(e) {}
                }

                 // ê°œë³„ ë°œí‘œ ê°„ ë”œë ˆì´
                if (i < winners.length - 1) {
                    await sleep(2000); // ë‹¤ìŒ ë‹¹ì²¨ì ë°œí‘œ ì „ ì ì‹œ ëŒ€ê¸°
                }
            }

            // ìµœì¢… ë°œí‘œ
            announceWinners(winnerIds);
        }

        // ìµœì¢… ë‹¹ì²¨ì ë°œí‘œ
        function announceWinners(winnerIds) {
            document.body.style.backgroundColor = '#ff6f00'; // ìµœì¢… ì£¼í™©ìƒ‰ ë°°ê²½

            // ìµœì¢… ì¶•í•˜ ë©”ì‹œì§€
            resultAnnouncement.textContent = `ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë‹¹ì²¨ì: ${winnerIds.join(', ')} ğŸ‰`;
            resultAnnouncement.classList.add('show'); // í™•ì‹¤íˆ ë³´ì´ê²Œ

            // ìƒ‰ì¢…ì´ íš¨ê³¼
            createConfetti();

            // ê²Œì„ ì¢…ë£Œ ë° ë¦¬ì…‹ í™œì„±í™”
            resetBtn.disabled = false;
            isGameRunning = false;
        }

        // ìƒ‰ì¢…ì´ íš¨ê³¼ í•¨ìˆ˜
        function createConfetti() {
            const colors = ['#FFC107', '#4CAF50', '#2196F3', '#E91E63', '#9C27B0', '#FFFFFF'];
            const confettiCount = 150; // ìƒ‰ì¢…ì´ ê°œìˆ˜ ì¦ê°€

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                // í™”ë©´ ìƒë‹¨ì—ì„œ ëœë¤í•œ ê°€ë¡œ ìœ„ì¹˜ì—ì„œ ì‹œì‘
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = '-10px'; // í™”ë©´ ë°”ë¡œ ìœ„ì—ì„œ ì‹œì‘
                confetti.style.opacity = '1';
                const size = Math.random() * 8 + 4; // í¬ê¸° ë‹¤ì–‘í™” (4px ~ 12px)
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;

                document.body.appendChild(confetti);

                const duration = Math.random() * 4 + 3; // ë–¨ì–´ì§€ëŠ” ì‹œê°„ (3ì´ˆ ~ 7ì´ˆ)
                const horizontalMovement = (Math.random() - 0.5) * window.innerWidth * 0.5; // ì¢Œìš° í”ë“¤ë¦¼

                // ì• ë‹ˆë©”ì´ì…˜ ì ìš©
                confetti.animate([
                    { transform: `translate(0, -10px) rotate(${Math.random() * 360}deg)`, opacity: 1 },
                    { transform: `translate(${horizontalMovement}px, ${window.innerHeight + 20}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: duration * 1000,
                    easing: 'linear',
                    iterations: 1
                });

                // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ìš”ì†Œ ì œê±°
                setTimeout(() => {
                     if (confetti.parentNode === document.body) {
                         document.body.removeChild(confetti);
                    }
                }, duration * 1000);
            }
        }


        // ê²Œì„ ë¦¬ì…‹ í•¨ìˆ˜
        function resetGame() {
             // ì§„í–‰ ì¤‘ì¸ ë‹¹ì²¨ì ê³µê°œ íƒ€ì„ì•„ì›ƒ í´ë¦¬ì–´
            revealTimeoutIds.forEach(clearTimeout);
            revealTimeoutIds = [];

             // ì‚¬ìš´ë“œ ì¤‘ì§€
            if (soundEnabled) {
                 try {
                    if (drumrollSound && !drumrollSound.paused) drumrollSound.pause();
                    if (successSound && !successSound.paused) successSound.pause();
                 } catch(e) {}
            }

            gameArea.innerHTML = '';
            resultAnnouncement.textContent = '';
            resultAnnouncement.classList.remove('show');
            document.body.style.backgroundColor = '#121212';

            startBtn.disabled = false;
            resetBtn.disabled = true;
            isGameRunning = false; // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”

            // ë‚¨ì•„ìˆëŠ” ìƒ‰ì¢…ì´ ì œê±° (ë” í™•ì‹¤í•˜ê²Œ)
             document.querySelectorAll('.confetti').forEach(c => c.remove());
        }

        // ìœ í‹¸ë¦¬í‹°: sleep í•¨ìˆ˜
        const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));

         // í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜¤ë””ì˜¤ ì´ˆê¸°í™”
        window.addEventListener('load', initAudio);

    </script>
</body>
</html>
